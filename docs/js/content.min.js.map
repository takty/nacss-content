{"version":3,"sources":["content.js"],"names":["window","NS","apply","ts","t","alt","src","trim","endsWith","substring","length","idx","lastIndexOf","applyImageAlt","figs","navigator","userAgent","toLowerCase","includes","fig","style","width","fcs","getElementsByTagName","fc","innerHTML","applyFigureCaption","fs","f","aspectRatio","w","h","extractIframeSize","parseInt","height","sW","sH","indexOf","applyIframeAspect","spans","opts","Object","assign","styleList","span","setStyle","type","textDecorationLine","re","RegExp","getAttribute","match","removeAttribute","tar","cls","enabled","val","key","substr","startsWith","dataset","c","join","classList","add","remove","setClass","applyUnderline"],"mappings":"AAUA,aAEAA,OAAM,MAAuBA,OAAM,OAAwB,GAC3DA,OAAM,MAAN,QAA6BA,OAAM,MAAN,SAA8B,GAG3D,CAAEC,IA+CD,CAWC,SAASC,EAAMC,GACd,IAAK,MAAMC,KAAKD,EACf,IAAKC,EAAEC,KAAOD,EAAEE,IAAK,CACpB,IAAIA,EAAMF,EAAEE,IAAIC,OACZD,EAAIE,SAAS,OAAMF,EAAMA,EAAIG,UAAU,EAAGH,EAAII,OAAS,IAC3D,MAAMC,EAAML,EAAIM,YAAY,KAC5B,IAAa,IAATD,EAAY,SAChBP,EAAEC,IAAMC,EAAIG,UAAUE,EAAM,IAK/BV,EAAGY,cAAgBX,EAEpB,CAYC,SAASA,EAAMY,GAEd,GADWd,OAAOe,UAAUC,UAAUC,cAC/BC,SAAS,WACf,IAAK,MAAMC,KAAOL,EAAM,CACvBK,EAAIC,MAAMC,MAAQ,GAElB,MAAMC,EAAMH,EAAII,qBAAqB,cAC/BC,EAAMF,EAAIZ,OAASY,EAAI,GAAK,KAC9BE,IACHA,EAAGC,UAAa,SAAQD,EAAGC,qBAM/BxB,EAAGyB,mBAAqBxB,EAEzB,CAWC,SAASA,EAAMyB,GACd,IAAK,MAAMC,KAAKD,EACf,IAAKC,EAAER,MAAMS,YAAa,CACzB,MAAOC,EAAGC,GAAKC,EAAkBJ,GAC7BE,GAAKC,IACRH,EAAER,MAAMS,YAAe,GAAEC,OAAOC,MAMpC,SAASC,EAAkBJ,GAC1B,IAAIE,EAAIG,SAASL,EAAEP,OACfU,EAAIE,SAASL,EAAEM,QACnB,GAAIJ,GAAKC,EAAG,MAAO,CAACD,EAAGC,GAEvB,MAAMI,EAAKP,EAAER,MAAMC,MACbe,EAAKR,EAAER,MAAMc,OACnB,OAAIC,EAAGE,QAAQ,QAAUF,EAAGzB,OAAS,GACjC0B,EAAGC,QAAQ,QAAUD,EAAG1B,OAAS,EADU,CAAC,EAAG,IAEnDoB,EAAIG,SAASE,GACbJ,EAAIE,SAASG,GACTN,GAAKC,EAAU,CAACD,EAAGC,GAChB,CAAC,EAAG,IAGZ9B,EAAGqC,kBAAoBpC,EAExB,CAWC,SAASA,EAAMqC,EAAOC,EAAO,IAC5BA,EAAOC,OAAOC,OAAO,CACpBC,UAAW,gBACTH,GAEH,IAAK,MAAMI,KAAQL,EAClBM,EAASD,EAAMJ,GAIjB,SAASK,EAASzC,EAAGoC,GACpB,MAAMM,EAAO1C,EAAEgB,MAAM2B,mBACrB,GAAa,cAATD,EAAsB,CACzB,MAAME,EAAK,IAAIC,OAAO,2BAA6BH,EAAO,SAAU,MAChE1C,EAAE8C,aAAa,SAASC,MAAMH,GACjC5C,EAAEgD,gBAAgB,SAElBhD,EAAEgB,MAAM2B,mBAAqB,GAnJjC,SAAkBM,EAAKC,EAAKC,GAAU,EAAMC,EAAM,IACjD,MAAMC,EAAMH,EAAII,OAAO,GACvB,GAAIJ,EAAIK,WAAW,KACdJ,EACHF,EAAIO,QAAQH,GAAOD,SAEZH,EAAIO,QAAQH,OAEd,CACN,MAAMI,EAAI,CAACJ,EAAKD,GAAKM,KAAK,KACtBP,EACHF,EAAIU,UAAUC,IAAIH,GAElBR,EAAIU,UAAUE,OAAOJ,IAwIrBK,CAAS9D,EAAGoC,EAAKG,YAInB1C,EAAGkE,eAAiBjE,IA9KtB,CAiLGF,OAAM,MAAN","file":"content.min.js","sourcesContent":["/**\n *\n * Content\n *\n * @author Takuto Yanagida\n * @version 2021-12-26\n *\n */\n\n\n'use strict';\n\nwindow['NACSS']            = window['NACSS']            || {};\nwindow['NACSS']['content'] = window['NACSS']['content'] || {};\n\n\n((NS) => {\n\n\t/**\n\t *\n\t * Style Class Utilities\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-11-11\n\t *\n\t */\n\t\n\t\n\tfunction hasClass(tar, cls) {\n\t\tconst key = cls.substr(1);\n\t\tif (cls.startsWith(':')) {\n\t\t\treturn tar.dataset[key] !== undefined;\n\t\t} else {\n\t\t\treturn tar.classList.contains(key);\n\t\t}\n\t}\n\t\n\tfunction setClass(tar, cls, enabled = true, val = '') {\n\t\tconst key = cls.substr(1);\n\t\tif (cls.startsWith(':')) {\n\t\t\tif (enabled) {\n\t\t\t\ttar.dataset[key] = val;\n\t\t\t} else {\n\t\t\t\tdelete tar.dataset[key];\n\t\t\t}\n\t\t} else {\n\t\t\tconst c = [key, val].join('-');\n\t\t\tif (enabled) {\n\t\t\t\ttar.classList.add(c);\n\t\t\t} else {\n\t\t\t\ttar.classList.remove(c);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfunction getSelector(cls) {\n\t\tif (cls.startsWith(':')) {\n\t\t\treturn `*[data-${cls.substr(1).replace(/([A-Z])/g, c => '-' + c.charAt(0).toLowerCase())}]`;\n\t\t} else {\n\t\t\treturn `*${cls}`;\n\t\t}\n\t}\n\t\n\t{\n\t\t/**\n\t\t *\n\t\t * Image Alt\n\t\t *\n\t\t * @author Takuto Yanagida\n\t\t * @version 2021-12-26\n\t\t *\n\t\t */\n\t\t\n\t\t\n\t\tfunction apply(ts) {\n\t\t\tfor (const t of ts) {\n\t\t\t\tif (!t.alt && t.src) {\n\t\t\t\t\tlet src = t.src.trim();\n\t\t\t\t\tif (src.endsWith('/')) src = src.substring(0, src.length - 1);\n\t\t\t\t\tconst idx = src.lastIndexOf('/');\n\t\t\t\t\tif (idx === -1) continue;\n\t\t\t\t\tt.alt = src.substring(idx + 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tNS.applyImageAlt = apply;\n\t}\n\t{\n\t\t/**\n\t\t *\n\t\t * Figure Caption\n\t\t *\n\t\t * @author Takuto Yanagida\n\t\t * @version 2021-12-26\n\t\t *\n\t\t */\n\t\t\n\t\t\n\t\t// Wrap figure captions with spans for Firefox\n\t\tfunction apply(figs) {\n\t\t\tconst ua = window.navigator.userAgent.toLowerCase();\n\t\t\tif (ua.includes('firefox')) {\n\t\t\t\tfor (const fig of figs) {\n\t\t\t\t\tfig.style.width = '';\n\t\t\n\t\t\t\t\tconst fcs = fig.getElementsByTagName('figcaption');\n\t\t\t\t\tconst fc  = fcs.length ? fcs[0] : null;\n\t\t\t\t\tif (fc) {\n\t\t\t\t\t\tfc.innerHTML = `<span>${fc.innerHTML}</span>`;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tNS.applyFigureCaption = apply;\n\t}\n\t{\n\t\t/**\n\t\t *\n\t\t * Iframe Aspect\n\t\t *\n\t\t * @author Takuto Yanagida\n\t\t * @version 2021-12-26\n\t\t *\n\t\t */\n\t\t\n\t\t\n\t\tfunction apply(fs) {\n\t\t\tfor (const f of fs) {\n\t\t\t\tif (!f.style.aspectRatio) {\n\t\t\t\t\tconst [w, h] = extractIframeSize(f);\n\t\t\t\t\tif (w && h) {\n\t\t\t\t\t\tf.style.aspectRatio = `${w} / ${h}`;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction extractIframeSize(f) {\n\t\t\tlet w = parseInt(f.width);\n\t\t\tlet h = parseInt(f.height);\n\t\t\tif (w && h) return [w, h];\n\t\t\n\t\t\tconst sW = f.style.width;\n\t\t\tconst sH = f.style.height;\n\t\t\tif (sW.indexOf('px') !== sW.length - 2) return [0, 0];\n\t\t\tif (sH.indexOf('px') !== sH.length - 2) return [0, 0];\n\t\t\tw = parseInt(sW);\n\t\t\th = parseInt(sH);\n\t\t\tif (w && h) return [w, h];\n\t\t\treturn [0, 0];\n\t\t}\n\t\t\n\t\tNS.applyIframeAspect = apply;\n\t}\n\t{\n\t\t/**\n\t\t *\n\t\t * Underline\n\t\t *\n\t\t * @author Takuto Yanagida\n\t\t * @version 2021-12-26\n\t\t *\n\t\t */\n\t\t\n\t\t\n\t\tfunction apply(spans, opts = {}) {\n\t\t\topts = Object.assign({\n\t\t\t\tstyleList: ':ncUnderline',\n\t\t\t}, opts);\n\t\t\n\t\t\tfor (const span of spans) {\n\t\t\t\tsetStyle(span, opts);\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction setStyle(t, opts) {\n\t\t\tconst type = t.style.textDecorationLine;\n\t\t\tif (type === 'underline') {\n\t\t\t\tconst re = new RegExp('text-decoration\\\\s*:\\\\s*' + type + '\\\\s*;?', 'gi');\n\t\t\t\tif (t.getAttribute('style').match(re)) {\n\t\t\t\t\tt.removeAttribute('style');\n\t\t\t\t} else {\n\t\t\t\t\tt.style.textDecorationLine = '';\n\t\t\t\t}\n\t\t\t\tsetClass(t, opts.styleList);\n\t\t\t}\n\t\t}\n\t\t\n\t\tNS.applyUnderline = apply;\n\t}\n\n})(window['NACSS']['content']);\n"]}